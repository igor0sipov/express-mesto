(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(1),o=a.n(i),r=a(7),s=a.n(r),c=(a(16),a(10)),l=a(3),u=a(2),d=a.p+"static/media/logo_white.8724261e.svg";var p=function(){return Object(n.jsx)("header",{className:"header header_spaced",children:Object(n.jsx)("a",{href:"#",children:Object(n.jsx)("img",{src:d,alt:"\u041b\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430",className:"header__logo"})})})},f=o.a.createContext();var b=function(e){var t=e.card.owner._id===e.currentUser._id,a=e.card.likes.some((function(t){return t._id===e.currentUser._id}));return Object(n.jsxs)("li",{className:"element",children:[Object(n.jsx)("button",{className:"element__delete-button ".concat(t?"":"element__delete-button_hidden"),onClick:function(){e.onDeleteClick(e.card)}}),Object(n.jsx)("img",{src:e.card.link,alt:"#",className:"element__picture",onClick:function(){e.onCardClick(e.card)}}),Object(n.jsx)("h2",{className:"element__name",children:e.card.name}),Object(n.jsxs)("figure",{className:"element__like",children:[Object(n.jsx)("button",{className:"element__like-button ".concat(a?"element__like-button_active":""),onClick:function(){e.onCardLike(e.card,a)}}),Object(n.jsx)("figcaption",{className:"element__like-counter",children:e.card.likes.length})]})]})},h=a.p+"static/media/edit-avatar-icon.ae1a976d.svg";var j=function(e){var t=o.a.useContext(f);return Object(n.jsxs)("main",{className:"main sizer",children:[Object(n.jsxs)("section",{className:"profile profile_spaced sizer",children:[Object(n.jsxs)("div",{className:"profile__avatar-wrapper",children:[Object(n.jsx)("img",{src:t.avatar,alt:"User Avatar",className:"profile__avatar"}),Object(n.jsx)("button",{className:"profile__edit-avatar-button",onClick:e.onEditAvatar,children:Object(n.jsx)("img",{src:h,alt:"",className:"profile__edit-avatar-icon"})})]}),Object(n.jsxs)("div",{className:"profile__info",children:[Object(n.jsx)("h1",{className:"profile__name",children:t.name}),Object(n.jsx)("p",{className:"profile__bio",children:t.about}),Object(n.jsx)("button",{className:"profile__edit-button",onClick:e.onEditProfile})]}),Object(n.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace})]}),Object(n.jsx)("ul",{className:"elements",children:e.cards.map((function(a){return Object(n.jsx)(b,{card:a,onCardClick:e.onCardClick,onDeleteClick:e.onDeleteClick,onCardLike:e.onLikeClick,currentUser:t},a._id)}))})]})};var m=function(){return Object(n.jsx)("footer",{className:"footer sizer",children:Object(n.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var v=function(e){return Object(n.jsx)("section",{className:"popup fullsize-picture ".concat(e.isOpened&&"popup_opened"),onClick:e.onOverlay,children:Object(n.jsxs)("figure",{className:"popup__container",children:[Object(n.jsx)("button",{type:"button",className:"popup__close-icon",onClick:e.onClose}),Object(n.jsx)("img",{src:e.card.link,alt:e.card.name,className:"popup__picture"}),Object(n.jsx)("figcaption",{className:"popup__caption",children:e.card.name})]})})},O=a(8),_=a(9),g=new(function(){function e(t){Object(O.a)(this,e),this._token=t.token,this._userProfileUrl=t.userProfileUrl,this._cardsUrl=t.cardsUrl}return Object(_.a)(e,[{key:"_handleOriginalResponse",value:function(e){return e.ok?e:Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch(this._userProfileUrl,{headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"getCards",value:function(){return fetch(this._cardsUrl,{headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"editProfile",value:function(e){var t=e.name,a=e.about;return fetch(this._userProfileUrl,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:a})}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"addCard",value:function(e){var t=e.name,a=e.link;return fetch(this._cardsUrl,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:a})}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"deleteCard",value:function(e){return fetch(this._cardsUrl+e,{method:"DELETE",headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e}))}},{key:"like",value:function(e){return fetch(this._cardsUrl+"likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"removeLike",value:function(e){return fetch(this._cardsUrl+"likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}},{key:"updateAvatar",value:function(e){return fetch(this._userProfileUrl+"avatar/",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._handleOriginalResponse).then((function(e){return e.json()}))}}]),e}())({token:"fe948c7b-c7fe-4065-b9c1-1b820e5df7d7",userProfileUrl:"https://mesto.nomoreparties.co/v1/cohort-17/users/me/",cardsUrl:"https://mesto.nomoreparties.co/v1/cohort-17/cards/"});var x=function(e){return Object(n.jsx)("section",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpened&&"popup_opened"),onClick:e.onOverlay,children:Object(n.jsxs)("form",{className:"popup__container form",name:e.name,onSubmit:e.onSubmit,noValidate:!0,children:[Object(n.jsx)("button",{type:"button",className:"popup__close-icon",onClick:e.onClose}),Object(n.jsx)("h3",{className:"popup__title",children:e.title}),e.children,Object(n.jsx)("button",{type:"submit",className:"popup__submit-button ".concat(e.isValid?"":"popup__submit-button_disabled"),children:e.buttonText})]})})};var k=function(e){var t=o.a.useContext(f),a=o.a.useState({value:t.name,isValid:!0}),i=Object(u.a)(a,2),r=i[0],s=i[1],c=o.a.useState({value:t.about,isvalid:!0}),l=Object(u.a)(c,2),d=l[0],p=l[1],b=o.a.useState(!1),h=Object(u.a)(b,2),j=h[0],m=h[1];return o.a.useEffect((function(){s({value:t.name,isValid:!0}),p({value:t.about,isValid:!0})}),[t]),o.a.useEffect((function(){r.isValid&&d.isValid?m(!0):m(!1)}),[r.isValid,d.isValid]),Object(n.jsxs)(x,{name:"editProfile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r.value,about:d.value})},isValid:j,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-name",name:"name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:r.value,onChange:function(e){s({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-name-error ".concat(r.isValid?"":"popup__input-error_visible"),children:r.validationMessage}),Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-bio",name:"bio",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",value:d.value,onChange:function(e){p({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-name-error ".concat(d.isValid?"":"popup__input-error_visible"),children:d.validationMessage})]})};var C=function(e){var t=o.a.useRef(),a=o.a.useState({value:""}),i=Object(u.a)(a,2),r=i[0],s=i[1],c=o.a.useState(!1),l=Object(u.a)(c,2),d=l[0],p=l[1];return o.a.useEffect((function(){r.isValid?p(!0):p(!1)}),[r.isValid]),o.a.useEffect((function(){e.isOpened||s({value:""})}),[e.isOpened]),Object(n.jsxs)(x,{name:"updateAvatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar(t.current.value)},isValid:d,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{ref:t,type:"url",className:"popup__input",id:"form-avatar",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0,minLength:"2",maxLength:"200",value:r.value,onChange:function(e){s({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-avatar-error ".concat(r.isValid?"":"popup__input-error_visible"),children:r.validationMessage})]})};var y=function(e){var t=o.a.useState({value:""}),a=Object(u.a)(t,2),i=a[0],r=a[1],s=o.a.useState({value:""}),c=Object(u.a)(s,2),l=c[0],d=c[1],p=o.a.useState(!1),f=Object(u.a)(p,2),b=f[0],h=f[1];return o.a.useEffect((function(){i.isValid&&l.isValid?h(!0):h(!1)}),[i.isValid,l.isValid]),o.a.useEffect((function(){e.isOpened||(r({value:""}),d({value:""}))}),[e.isOpened]),Object(n.jsxs)(x,{name:"addPlace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(t){t.preventDefault(),e.onSubmit({name:i.value,link:l.value})},isValid:b,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-title",name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0,value:i.value,onChange:function(e){r({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-title-error ".concat(i.isValid?"":"popup__input-error_visible"),children:i.validationMessage}),Object(n.jsx)("input",{type:"url",className:"popup__input",id:"form-url",name:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:l.value,onChange:function(e){d({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-url-error ".concat(l.isValid?"":"popup__input-error_visible"),children:l.validationMessage})]})};var N=function(e){return Object(n.jsx)(x,{name:"confirmDelete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onOverlay:e.onOverlay,isValid:!0,onSubmit:function(t){t.preventDefault(),e.onSubmit(e.deleteCard)}})};var S=function(){function e(e){console.log(e)}var t="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",a="\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",i=o.a.useState({name:"User Name",about:"User Bio"}),r=Object(u.a)(i,2),s=r[0],d=r[1],b=o.a.useState(!1),h=Object(u.a)(b,2),O=h[0],_=h[1],x=o.a.useState(!1),S=Object(u.a)(x,2),P=S[0],U=S[1],V=o.a.useState(!1),T=Object(u.a)(V,2),E=T[0],L=T[1],M=o.a.useState(!1),A=Object(u.a)(M,2),D=A[0],z=A[1],R=o.a.useState(!1),w=Object(u.a)(R,2),q=w[0],J=w[1],F=o.a.useState({}),I=Object(u.a)(F,2),B=I[0],H=I[1],G=o.a.useState({addPlace:t,editProfile:t,editAvatar:t,confirmDelete:"\u0414\u0430"}),K=Object(u.a)(G,2),Q=K[0],W=K[1],X=o.a.useState({}),Y=Object(u.a)(X,2),Z=Y[0],$=Y[1],ee=o.a.useState([]),te=Object(u.a)(ee,2),ae=te[0],ne=te[1];function ie(){L(!1),_(!1),U(!1),z(!1),J(!1)}function oe(e){27===e.keyCode&&ie()}function re(e){e.target===e.currentTarget&&ie()}return o.a.useEffect((function(){Promise.all([g.getUserInfo(),g.getCards()]).then((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];d(a),ne(n)})).catch(e)}),[]),o.a.useEffect((function(){return document.addEventListener("keydown",oe),function(){document.removeEventListener("keydown",oe)}}),[]),Object(n.jsx)("div",{className:"page",children:Object(n.jsxs)(f.Provider,{value:s,children:[Object(n.jsx)(p,{}),Object(n.jsx)(j,{onEditProfile:function(){_(!0)},onAddPlace:function(){U(!0)},onEditAvatar:function(){L(!0)},onCardClick:function(e){H(e),z(!0)},cards:ae,onLikeClick:function(t,a){function n(e){var a=ae.map((function(a){return a._id===t._id?e:a}));ne(a)}a?g.removeLike(t._id).then(n).catch(e):g.like(t._id).then(n).catch(e)},onDeleteClick:function(e){J(!0),$(e)}}),Object(n.jsx)(m,{}),Object(n.jsx)(k,{isOpened:O,onClose:ie,onUpdateUser:function(n){var i=n.name,o=n.about;W(Object(l.a)(Object(l.a)({},Q),{},{editProfile:a})),g.editProfile({name:i,about:o}).then((function(e){d(e),W(Object(l.a)(Object(l.a)({},Q),{},{editProfile:t})),ie()})).catch(e)},buttonText:Q.editProfile,onOverlay:re,escClosing:oe}),Object(n.jsx)(y,{isOpened:P,onClose:ie,onSubmit:function(n){var i=n.name,o=n.link;W(Object(l.a)(Object(l.a)({},Q),{},{addPlace:a})),g.addCard({name:i,link:o}).then((function(e){ne([e].concat(Object(c.a)(ae))),W(Object(l.a)(Object(l.a)({},Q),{},{addPlace:t})),ie()})).catch(e)},buttonText:Q.addPlace,onOverlay:re}),Object(n.jsx)(C,{isOpened:E,onClose:ie,onUpdateAvatar:function(n){W(Object(l.a)(Object(l.a)({},Q),{},{editAvatar:a})),g.updateAvatar(n).then((function(e){d(e),W(Object(l.a)(Object(l.a)({},Q),{},{editAvatar:t})),ie()})).catch(e)},buttonText:Q.editAvatar,onOverlay:re}),Object(n.jsx)(N,{isOpened:q,onClose:ie,buttonText:Q.confirmDelete,onOverlay:re,onSubmit:function(t){W(Object(l.a)(Object(l.a)({},Q),{},{confirmDelete:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."})),g.deleteCard(t._id).then((function(e){if(e.ok){var a=ae.filter((function(e){return e._id!==t._id}));ne(a)}else console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ",e.status);W(Object(l.a)(Object(l.a)({},Q),{},{confirmDelete:"\u0414\u0430"})),ie()})).catch(e)},deleteCard:Z}),Object(n.jsx)(v,{card:B,isOpened:D,onClose:ie,onOverlay:re})]})})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,r=t.getTTFB;a(e),n(e),i(e),o(e),r(e)}))};s.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(S,{})}),document.getElementById("root")),P()}},[[17,1,2]]]);
//# sourceMappingURL=main.9d3659ad.chunk.js.map